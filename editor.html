<!DOCTYPE html>
<html>
  <head>
    <title>TAG SCRIPT EDITOR</title>
    <!-- Latest compiled and minified CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Latest compiled JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- jQuery Custom Scroller CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.concat.min.js"></script>
    <!-- Scrollbar Custom CSS -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.min.css"
    />
    <link rel="stylesheet" href="editor_css.css" />
  </head>
  <body>
    <div class="wrapper">
      <!-- Sidebar  -->
      <nav id="sidebar">
        <div class="sidebar-header">
          <h3>TAG Script Generator</h3>
        </div>

        <ul class="list-unstyled components">
          <li class="active">
            <a href="">Scripts</a>
          </li>
          <!--<li>
            <a href="">Google Analytics 4</a>
          </li>
          <li>
            <a href="">Google Ads Conversions</a>
          </li>-->
        </ul>
        <ul class="list-unstyled components">
          <li><a>Made by Jihwan Jeong</a></li>
        </ul>
      </nav>

      <!-- Page Content  -->
      <div id="content">
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
          <div class="container-fluid">
            <button type="button" id="sidebarCollapse" class="btn btn-info">
              <i class="fas fa-align-left"></i>
              <span>Toggle Sidebar</span>
            </button>
          </div>
        </nav>

        <nav>
          <div class="nav nav-tabs" id="nav-tab" role="tablist">
            <button
              class="nav-link active"
              id="nav-ua-tab"
              data-bs-toggle="tab"
              data-bs-target="#nav-ua"
              type="button"
              role="tab"
              aria-controls="nav-ua"
              aria-selected="true"
            >
              UA Event
            </button>
            <button
              class="nav-link"
              id="nav-ga4-tab"
              data-bs-toggle="tab"
              data-bs-target="#nav-ga4"
              type="button"
              role="tab"
              aria-controls="nav-ga4"
              aria-selected="false"
            >
              GA4 Event
            </button>
            <button
              class="nav-link"
              id="nav-ads-tab"
              data-bs-toggle="tab"
              data-bs-target="#nav-ads"
              type="button"
              role="tab"
              aria-controls="nav-ads"
              aria-selected="false"
            >
              Ads Conversion
            </button>
          </div>
        </nav>

        <div class="tab-content" id="nav-tabContent">
          <div
            class="tab-pane fade show active"
            id="nav-ua"
            role="tabpanel"
            aria-labelledby="nav-ua-tab"
          >
            <div>
              <br />
              <h2>UA Event Script Generator</h2>
              <div class="line"></div>
              <button id="ua_add_button" class="btn btn-primary">
                Add Event
              </button>
              &nbsp;
              <button id="ua_reset_events" class="btn btn-danger">
                Reset Events
              </button>
              &nbsp;
              <button id="ua_generate_script" class="btn btn-success">
                Generate Script
              </button>
              &nbsp;
              <button id="ua_clear_script" class="btn btn-warning">
                Clear Script
              </button>
              <div class="line"></div>
              <h2>Conditions</h2>
              <div><form id="ua_conditions" autocomplete="off"></form></div>
              <div class="line"></div>
              <h2>UA Generated Script</h2>
              <div id="ua_generated_script" class="script_part"></div>
              <div class="line"></div>
            </div>
          </div>
          <div
            class="tab-pane fade"
            id="nav-ga4"
            role="tabpanel"
            aria-labelledby="nav-ga4-tab"
          >
            <div>
              <br />
              <h2>GA4 Event Script Generator</h2>
              <div class="line"></div>
              <button id="ga4_add_button" class="btn btn-primary">
                Add Event
              </button>
              &nbsp;
              <button id="ga4_reset_events" class="btn btn-danger">
                Reset Events
              </button>
              &nbsp;
              <button id="generate_ga4_script" class="btn btn-success">
                Generate Script
              </button>
              &nbsp;
              <div class="line"></div>
              <h2>Conditions</h2>
              <div><form id="ga4_conditions" autocomplete="off"></form></div>
              <div class="line"></div>
              <h2>GA4 Generated Script</h2>
              <div id="generated_ga4_script" class="script_part"></div>
            </div>
          </div>
          <div
            class="tab-pane fade"
            id="nav-ads"
            role="tabpanel"
            aria-labelledby="nav-ads-tab"
          >
            <!-- ADS CONVERSION -->
            <div>
              <br />
              <h2>Ads Conversion Script Generator</h2>
              <div class="line"></div>
              <button id="ads_add_button" class="btn btn-primary">
                Add Conversion
              </button>
              &nbsp;
              <button id="ads_reset_events" class="btn btn-danger">
                Reset Conversions
              </button>
              &nbsp;
              <button id="generate_ads_script" class="btn btn-success">
                Generate Script
              </button>
              &nbsp;
              <div class="line"></div>
              <h2>Conditions</h2>
              <div><form id="ads_conditions" autocomplete="off"></form></div>
              <div class="line"></div>
              <h2>Ads Conversion Generated Script</h2>
              <div id="generated_ads_script" class="script_part"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      $(document).ready(function () {
        $("#sidebarCollapse").on("click", function () {
          $("#sidebar").toggleClass("active");
        });

        // UNIVERSAL ANALYTICS
        let ua_event_size = 0;

        $("#ua_add_button").on("click", function () {
          ua_event_size++;
          $("#ua_conditions").append(
            "<p id=" +
              ua_event_size +
              "><b>Event " +
              ua_event_size +
              " </b> &nbsp; CSS Selector: <input type='text' class='ua_css_selector'/> &nbsp; Action: <input type='text' class='ua_event_action'/> &nbsp; Category: <input type='text' class='ua_event_category'/> &nbsp;</p>"
          );
        });
        $("#ua_generate_script").on("click", function () {
          let ua_event_actions = $(".ua_event_action");
          let ua_event_categories = $(".ua_event_category");
          let ua_css_selectors = $(".ua_css_selector");
          let result =
            "<span class='grey'>&lt;</span><span class='lightblue2'>script</span><span class='grey'>&gt;</span>";
          result +=
            "<br />  <span class='lightblue1'>window</span>.<span class='yellow'>addEventListener</span>(<span class='red2'>&apos;load&apos;</span>, <span class='lightblue2'>function</span>(<span class='yellow'>event</span>) {";
          for (var i = 0; i < ua_css_selectors.length; i++) {
            result +=
              "<br />    <span class='lightblue1'>document</span>.<span class='yellow'>querySelector</span>(<span class='red2'>&quot;" +
              ua_css_selectors[i].value +
              "&quot;</span>)?.<span class='yellow'>addEventListener</span>(<span class='red2'>&quot;click&quot;</span>, <span class='lightblue2'>function</span>() {<br />";
            result +=
              "      <span class='yellow'>gtag</span>(<span class='red2'>&apos;event&apos;</span>, <span class='red2'>&apos;" +
              ua_event_actions[i].value +
              "&apos;</span>, {<br />";
            result +=
              "        <span class='red2'>&apos;event_category&apos;</span>: <span class='red2'>&apos;" +
              ua_event_categories[i].value +
              "&apos;</span><br />";
            result += "      });<br />";
            result += "    });";
          }
          result += "<br />  });";
          result +=
            "<br /><span class='grey'>&lt;/<span class='lightblue2'>script</span><span class='grey'>&gt;</span>";
          $("#ua_generated_script").html("<pre>" + result + "</pre>");
        });
        $("#ua_reset_events").on("click", function () {
          ua_event_size = 0;
          $("#ua_conditions").empty();
        });
        $("#ua_clear_script").on("click", function () {
          $("#ua_generated_script").empty();
        });

        // ADS CONVERSION
        let ads_conversion_size = 0;

        $("#ads_add_button").on("click", function () {
          ads_conversion_size++;
          $("#ads_conditions").append(
            "<table class='table table-borderless'><tbody><tr><td><p id=" +
              ads_conversion_size +
              "><b>Conversion " +
              ads_conversion_size +
              " </b></p></td><td>Type: <select class='conversion_type'><option value='pageview_equal'>Page View (Equal)</option><option value='pageview_contain'>Page View (Contain)</option><option value='click'>Click</option><option value='click_multiple'>Multiple Clicks</option></select></td><td>URL/Selector: <input type='text' class='ads_page_url_or_selector'/></td><td>Conversion ID: <input type='text' class='ads_cid'/></td><td></tr><tr><td>Conversion Label: <input type='text' class='ads_clabel'/></td><td>Conversion value: <input type='text' class='ads_cvalue'/></td><td>Transaction ID: <input type='text' class='ads_tid'/></td><td>Currency: <input type='text' class='ads_currency'/></td></tr></tbody></table>"
          );
        });
        $("#generate_ads_script").on("click", function () {
          let conversion_types = $(".conversion_type");
          let ads_page_urls_or_selectors = $(".ads_page_url_or_selector");
          let ads_cids = $(".ads_cid");
          let ads_clabels = $(".ads_clabel");
          let ads_cvalues = $(".ads_cvalue");
          let ads_transactionIds = $(".ads_tid");
          let ads_currencies = $(".ads_currency");

          let result =
            "<span class='grey'>&lt;</span><span class='lightblue2'>script</span><span class='grey'>&gt;</span>";
          result +=
            "<br />  <span class='lightblue1'>window</span>.<span class='yellow'>addEventListener</span>(<span class='red2'>&apos;load&apos;</span>, <span class='lightblue2'>function</span>(<span class='yellow'>event</span>) {";
          for (var i = 0; i < ads_page_urls_or_selectors.length; i++) {
            // ADS CONVERSION PAGEVIEW
            if (conversion_types[i].value == "pageview_equal") {
              result +=
                "<br />    <span class='lightblue1'>if</span> (window.location.href == <span class='red2'>'" +
                ads_page_urls_or_selectors[i].value +
                "'</span>) {<br />";
              result +=
                "      <span class='yellow'>gtag</span>(<span class='red2'>&apos;event&apos;</span>, <span class='red2'>&apos;" +
                "conversion" +
                "&apos;</span>, {<br />";
              result +=
                "        <span class='red2'>&apos;send_to&apos;</span>: <span class='red2'>&apos;" +
                "AW-" +
                ads_cids[i].value +
                "/" +
                ads_clabels[i].value +
                "&apos;</span>";
              if (ads_cvalues[i].value != "") {
                result +=
                  ",<br />" +
                  "        <span class='red2'>&apos;value&apos;</span>: <span class='red2'>" +
                  ads_cvalues[i].value +
                  "</span>";
              }
              if (ads_currencies[i].value != "") {
                result +=
                  ",<br />" +
                  "        <span class='red2'>&apos;currency&apos;</span>: <span class='red2'>&apos;" +
                  ads_currencies[i].value +
                  "&apos;</span>";
              }
              if (ads_transactionIds[i].value != "") {
                result +=
                  ",<br />" +
                  "        <span class='red2'>&apos;transaction_id&apos;</span>: <span class='red2'>&apos;" +
                  ads_transactionIds[i].value +
                  "&apos;</span>";
              }
              result += "<br />      });<br />";
              result += "    }";
            }
            // ADS_PAGEVIEW_CONTAIN
            else if (conversion_types[i].value == "pageview_contain") {
              result +=
                "<br />    <span class='lightblue1'>if</span> (window.location.href.indexOf(<span class='red2'>'" +
                ads_page_urls_or_selectors[i].value +
                "'</span>) &gt; -1) {<br />";
              result +=
                "      <span class='yellow'>gtag</span>(<span class='red2'>&apos;event&apos;</span>, <span class='red2'>&apos;" +
                "conversion" +
                "&apos;</span>, {<br />";
              result +=
                "        <span class='red2'>&apos;send_to&apos;</span>: <span class='red2'>&apos;" +
                "AW-" +
                ads_cids[i].value +
                "/" +
                ads_clabels[i].value +
                "&apos;</span>";
              if (ads_cvalues[i].value != "") {
                result +=
                  ",<br />" +
                  "        <span class='red2'>&apos;value&apos;</span>: <span class='red2'>&apos;" +
                  ads_cvalues[i].value +
                  "&apos;</span>";
              }
              if (ads_currencies[i].value != "") {
                result +=
                  ",<br />" +
                  "        <span class='red2'>&apos;currency&apos;</span>: <span class='red2'>&apos;" +
                  ads_currencies[i].value +
                  "&apos;</span>";
              }
              if (ads_transactionIds[i].value != "") {
                result +=
                  ",<br />" +
                  "        <span class='red2'>&apos;transaction_id&apos;</span>: <span class='red2'>&apos;" +
                  ads_transactionIds[i].value +
                  "&apos;</span>";
              }
              result += "<br />      });<br />";
              result += "    }";
            }

            // ADS CONVERSION CLICK ONE
            else if (conversion_types[i].value == "click") {
              result +=
                "<br />    <span class='lightblue1'>document</span>.<span class='yellow'>querySelector</span>(<span class='red2'>&quot;" +
                ads_page_urls_or_selectors[i].value +
                "&quot;</span>)?.<span class='yellow'>addEventListener</span>(<span class='red2'>&quot;click&quot;</span>, <span class='lightblue2'>function</span>() {<br />";
              result +=
                "      <span class='yellow'>gtag</span>(<span class='red2'>&apos;event&apos;</span>, <span class='red2'>&apos;" +
                "conversion" +
                "&apos;</span>, {<br />";
              result +=
                "        <span class='red2'>&apos;send_to&apos;</span>: <span class='red2'>&apos;" +
                "AW-" +
                ads_cids[i].value +
                "/" +
                ads_clabels[i].value +
                "&apos;</span>";
              if (ads_cvalues[i].value != "") {
                result +=
                  ",<br />" +
                  "        <span class='red2'>&apos;value&apos;</span>: <span class='red2'>&apos;" +
                  ads_cvalues[i].value +
                  "&apos;</span>";
              }
              if (ads_currencies[i].value != "") {
                result +=
                  ",<br />" +
                  "        <span class='red2'>&apos;currency&apos;</span>: <span class='red2'>&apos;" +
                  ads_currencies[i].value +
                  "&apos;</span>";
              }
              if (ads_transactionIds[i].value != "") {
                result +=
                  ",<br />" +
                  "        <span class='red2'>&apos;transaction_id&apos;</span>: <span class='red2'>&apos;" +
                  ads_transactionIds[i].value +
                  "&apos;</span>";
              }
              result += "<br />      });<br />";
              result += "    });";
            }
          }
          result += "<br />  });";
          result +=
            "<br /><span class='grey'>&lt;/<span class='lightblue2'>script</span><span class='grey'>&gt;</span>";
          $("#generated_ads_script").html("<pre>" + result + "</pre>");
        });
        $("#ua_reset_events").on("click", function () {
          ua_event_size = 0;
          $("#ua_conditions").empty();
        });
        $("#ua_clear_script").on("click", function () {
          $("#ua_generated_script").empty();
        });
      });
    </script>
  </body>
</html>
